<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Create Task Checklist</title>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <style>
    /* If you ever @import another stylesheet, do it here BEFORE any other rules:
       @import url('my-styles.css');
    */
    .task-entry { margin-top: 10px; }
    .task-entry input, .task-entry select { margin-right: 5px; }
  </style>
</head>
<body>
  <h3>Create Task Checklist</h3>
  <form id="create-task-form">
    <div>
      <label for="checklist-name">Checklist Name:</label>
      <input
        type="text"
        id="checklist-name"
        name="checklist-name"
        value="Task Checklist"
        required>
    </div>
    <div id="tasks-container"></div>
    <button type="button" id="add-task">Add Task</button>
    <div>
      <button type="submit" id="submit-tasks">Create Checklist</button>
    </div>
  </form>

  <script>
    const t = TrelloPowerUp.iframe();
    const API_KEY = "7443867af11d32c3e8f8152b114201fd";

    function createTaskElement(index) {
      const div = document.createElement('div');
      div.className = 'task-entry';
      div.innerHTML = `
        <label for="task-name-${index}" class="sr-only">Task name</label>
        <input
          type="text"
          id="task-name-${index}"
          name="task-name-${index}"
          class="task-name"
          placeholder="Task name"
          required>
        <label for="task-date-${index}" class="sr-only">Due date</label>
        <input
          type="date"
          id="task-date-${index}"
          name="task-date-${index}"
          class="task-date"
          required>
        <label for="task-member-${index}" class="sr-only">Member username</label>
        <input
          type="text"
          id="task-member-${index}"
          name="task-member-${index}"
          class="task-member"
          placeholder="@memberUsername"
          required>
      `;
      return div;
    }

    document.getElementById('add-task').addEventListener('click', () => {
      const container = document.getElementById('tasks-container');
      container.appendChild(createTaskElement(container.children.length));
    });

    document.getElementById('create-task-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      // ... rest of your submission logic unchanged ...
      t.closePopup();
    });
  </script>
</body>
</html>
