<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Task Checklist</title>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 10px;
    }
    .task-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .task-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #f4f5f7;
      border-radius: 10px;
      padding: 8px 12px;
      margin-bottom: 6px;
    }
    .task-name {
      font-size: 14px;
      font-weight: 500;
      flex: 1;
      border: none;
      background: transparent;
      outline: none;
    }
    .task-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .task-actions img {
      width: 20px;
      height: 20px;
      cursor: pointer;
      opacity: 0.7;
    }
    .task-actions img:hover {
      opacity: 1;
    }
    .add-task-btn {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      background-color: #026aa7;
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
  </style>
</head>

<body>

  <ul id="task-list" class="task-list"></ul>
  <button id="add-task" class="add-task-btn">+ Add New Task</button>

  <script>
    const t = TrelloPowerUp.iframe();
    const taskList = document.getElementById('task-list');
    const addTaskBtn = document.getElementById('add-task');

    addTaskBtn.addEventListener('click', () => {
      const li = document.createElement('li');
      li.className = 'task-item';

      const input = document.createElement('input');
      input.className = 'task-name';
      input.type = 'text';
      input.placeholder = 'Task name...';

      const actions = document.createElement('div');
      actions.className = 'task-actions';
      actions.innerHTML = `
        <img src="https://cdn-icons-png.flaticon.com/512/61/61112.png" title="Set Due Date" class="due-date-btn">
        <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" title="Assign Member" class="assign-btn">
        <img src="https://cdn-icons-png.flaticon.com/512/512/512142.png" title="More" class="more-btn">
      `;

      li.appendChild(input);
      li.appendChild(actions);
      taskList.appendChild(li);

      input.focus();

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && input.value.trim() !== '') {
          input.disabled = true;
        }
      });

      actions.querySelector('.due-date-btn').addEventListener('click', () => {
        alert('Pick a calendar date (calendar picker will be implemented)');
      });

      actions.querySelector('.assign-btn').addEventListener('click', () => {
        alert('Pick a member from the board (list will be implemented)');
      });

      actions.querySelector('.more-btn').addEventListener('click', () => {
        const choice = prompt('Create Task Card or Delete Task? (type create or delete)');
        if (choice === 'delete') li.remove();
        else if (choice === 'create') alert('Task card would be created here (API call next)');
      });
    });

    t.render(function(){
      return t.sizeTo('#task-list');
    });
  </script>

</body>
</html>
