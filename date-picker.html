<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Select Due Date</title>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body style="font-family:sans-serif;padding:10px">
  <input id="date-input" type="date" style="width:100%;padding:6px;font-size:14px" />
  <script>
    const t = TrelloPowerUp.iframe();
    console.log('[Date Picker] Initialized');

    const input = document.getElementById('date-input');
    input.valueAsDate = new Date();
    console.log('[Date Picker] Default set to today:', input.value);

    input.addEventListener('change', () => {
      const val = new Date(input.value);
      const formatted = val.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      console.log('[Date Picker] User selected:', formatted);
      t.closePopup(formatted);
    });
  </script>
</body>
</html>
